#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

### BACKEND
echo "ğŸ” Verificando push backend..."

cd backend || exit 1

# 1ï¸âƒ£ FormataÃ§Ã£o
dotnet format analyzers --verify-no-changes --verify-no-changes
if [ $? -ne 0 ]; then
  echo "âŒ CÃ³digo nÃ£o estÃ¡ formatado. Execute 'dotnet format analyzers --verify-no-changes'."
  exit 1
fi

# 2ï¸âƒ£ Build
dotnet build --no-restore -warnaserror
if [ $? -ne 0 ]; then
  echo "âŒ Build falhou."
  exit 1
fi

# 3ï¸âƒ£ Testes unitÃ¡rios
echo "ğŸƒ Rodando testes unitÃ¡rios..."
dotnet test ./UnitTests/UnitTests.csproj --no-build --verbosity normal
if [ $? -ne 0 ]; then
  echo "âŒ Testes unitÃ¡rios falharam."
  exit 1
fi

echo "âœ… Push aprovado."
